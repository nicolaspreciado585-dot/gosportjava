<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Estado del Pago - GoSports</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        .status-icon {
            font-size: 5rem;
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
        <div class="container">
            <a class="navbar-brand" th:href="@{/home}">
                <img th:src="@{/images/Logo_Gosport.jpeg}" alt="GoSports Logo" style="height: 40px; margin-right: 10px;">
                <span class="fw-bold">GoSports</span>
            </a>
        </div>
    </nav>

    <div class="container my-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                
                <!-- PAGO APROBADO -->
                <div th:if="${pago.estado.name() == 'APROBADO'}" class="card shadow-lg border-0">
                    <div class="card-body text-center py-5">
                        <i class="bi bi-check-circle-fill text-success status-icon"></i>
                        <h1 class="display-4 text-success mt-3">¡Pago Exitoso!</h1>
                        <p class="lead">Tu reserva ha sido confirmada</p>
                        
                        <div class="alert alert-success mt-4">
                            <h5>
                                <i class="bi bi-envelope"></i> 
                                Te hemos enviado la confirmación a:
                            </h5>
                            <strong th:text="${pago.emailPagador}">email@example.com</strong>
                        </div>

                        <!-- Detalles del Pago -->
                        <div class="card mt-4 bg-light">
                            <div class="card-body text-start">
                                <h6 class="mb-3">Detalles de la Transacción</h6>
                                <div class="row">
                                    <div class="col-6 mb-2">
                                        <small class="text-muted">Referencia:</small><br>
                                        <strong th:text="${pago.referenciaPago}">REF-123</strong>
                                    </div>
                                    <div class="col-6 mb-2">
                                        <small class="text-muted">Monto:</small><br>
                                        <strong class="text-success">
                                            $<span th:text="${#numbers.formatDecimal(pago.monto, 0, 'COMMA', 0, 'POINT')}">80,000</span> COP
                                        </strong>
                                    </div>
                                    <div class="col-6 mb-2">
                                        <small class="text-muted">Método de Pago:</small><br>
                                        <strong th:text="${pago.metodoPago.displayName}">PSE</strong>
                                    </div>
                                    <div class="col-6 mb-2">
                                        <small class="text-muted">Fecha:</small><br>
                                        <strong th:text="${#temporals.format(pago.fechaPago, 'dd/MM/yyyy HH:mm')}">01/01/2024</strong>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Botones de Acción -->
                        <div class="mt-4 d-flex gap-2 justify-content-center">
                            <a th:href="@{/reservas/detalle/{id}(id=${pago.reserva.id})}" 
                               class="btn btn-success btn-lg">
                                <i class="bi bi-ticket-detailed"></i> Ver Reserva
                            </a>
                            <a th:href="@{/home}" class="btn btn-outline-secondary btn-lg">
                                <i class="bi bi-house"></i> Ir al Inicio
                            </a>
                        </div>
                    </div>
                </div>

                <!-- PAGO PENDIENTE -->
                <div th:if="${pago.estado.name() == 'PENDIENTE' || pago.estado.name() == 'PROCESANDO'}" 
                     class="card shadow-lg border-0">
                    <div class="card-body text-center py-5">
                        <div class="spinner-border text-warning status-icon" role="status">
                            <span class="visually-hidden">Cargando...</span>
                        </div>
                        <h1 class="display-4 text-warning mt-3">Pago en Proceso</h1>
                        <p class="lead">Estamos verificando tu pago</p>
                        
                        <div class="alert alert-warning mt-4">
                            <i class="bi bi-hourglass-split"></i>
                            Tu pago está siendo procesado. Esto puede tardar unos minutos.
                        </div>

                        <button onclick="location.reload()" class="btn btn-warning btn-lg mt-3">
                            <i class="bi bi-arrow-clockwise"></i> Actualizar Estado
                        </button>
                    </div>
                </div>

                <!-- PAGO RECHAZADO -->
                <div th:if="${pago.estado.name() == 'RECHAZADO' || pago.estado.name() == 'ERROR'}" 
                     class="card shadow-lg border-0">
                    <div class="card-body text-center py-5">
                        <i class="bi bi-x-circle-fill text-danger status-icon"></i>
                        <h1 class="display-4 text-danger mt-3">Pago Rechazado</h1>
                        <p class="lead">Hubo un problema con tu pago</p>
                        
                        <div class="alert alert-danger mt-4">
                            <i class="bi bi-exclamation-triangle"></i>
                            Tu pago no pudo ser procesado. Por favor, intenta nuevamente con otro método de pago.
                        </div>

                        <div class="mt-4 d-flex gap-2 justify-content-center">
                            <a th:href="@{/pagos/metodo/{id}(id=${pago.reserva.id})}" 
                               class="btn btn-danger btn-lg">
                                <i class="bi bi-arrow-repeat"></i> Intentar Nuevamente
                            </a>
                            <a th:href="@{/reservas/mis-reservas}" 
                               class="btn btn-outline-secondary btn-lg">
                                <i class="bi bi-arrow-left"></i> Mis Reservas
                            </a>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>